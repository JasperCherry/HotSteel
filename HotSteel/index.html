<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<style>
canvas {
    border:1px solid #d3d3d3;
    background-color: #f1f1f1;
    padding-left: 0;
    padding-right: 0;
    margin-left: auto;
    margin-right: auto;
    display: block;
}
</style>
</head>
<body onload="startGame()">

<img src="tanks/rusa.png" id="rusa" style="display: none;">
<img src="tanks/rusb.png" id="rusb" style="display: none;">
<img src="tanks/gera.png" id="gera" style="display: none;">
<img src="tanks/gerb.png" id="gerb" style="display: none;">
<img src="tanks/gera2.png" id="gera2" style="display: none;">
<img src="tanks/gerb2.png" id="gerb2" style="display: none;">
<img src="tanks/gera3.png" id="gera3" style="display: none;">
<img src="tanks/gerb3.png" id="gerb3" style="display: none;">

<img src="tanks/srusa.png" id="srusa" style="display: none;">
<img src="tanks/srusb.png" id="srusb" style="display: none;">
<img src="tanks/sgera.png" id="sgera" style="display: none;">
<img src="tanks/sgerb.png" id="sgerb" style="display: none;">
<img src="tanks/sgera2.png" id="sgera2" style="display: none;">
<img src="tanks/sgerb2.png" id="sgerb2" style="display: none;">
<img src="tanks/sgera3.png" id="sgera3" style="display: none;">
<img src="tanks/sgerb3.png" id="sgerb3" style="display: none;">

<img src="wrecks/rusaw.png" id="rusaw" style="display: none;">
<img src="wrecks/rusbw.png" id="rusbw" style="display: none;">
<img src="wrecks/geraw.png" id="geraw" style="display: none;">
<img src="wrecks/gerbw.png" id="gerbw" style="display: none;">
<img src="wrecks/geraw2.png" id="geraw2" style="display: none;">
<img src="wrecks/gerbw2.png" id="gerbw2" style="display: none;">
<img src="wrecks/geraw3.png" id="geraw3" style="display: none;">
<img src="wrecks/gerbw3.png" id="gerbw3" style="display: none;">

<img src="wrecks/srusaw.png" id="srusaw" style="display: none;">
<img src="wrecks/srusbw.png" id="srusbw" style="display: none;">
<img src="wrecks/sgeraw.png" id="sgeraw" style="display: none;">
<img src="wrecks/sgerbw.png" id="sgerbw" style="display: none;">
<img src="wrecks/sgeraw2.png" id="sgeraw2" style="display: none;">
<img src="wrecks/sgerbw2.png" id="sgerbw2" style="display: none;">
<img src="wrecks/sgeraw3.png" id="sgeraw3" style="display: none;">
<img src="wrecks/sgerbw3.png" id="sgerbw3" style="display: none;">


<img src="bullets/mgb.png" id="mgb" style="display: none;">
<img src="bullets/b.png" id="b" style="display: none;">
<img src="bullets/b2.png" id="b2" style="display: none;">

<img src="fire/loop/l0.png" id="l0" style="display: none;">
<img src="fire/loop/l1.png" id="l1" style="display: none;">
<img src="fire/loop/l2.png" id="l2" style="display: none;">
<img src="fire/loop/l3.png" id="l3" style="display: none;">
<img src="fire/loop/l4.png" id="l4" style="display: none;">
<img src="fire/loop/l5.png" id="l5" style="display: none;">
<img src="fire/loop/l6.png" id="l6" style="display: none;">
<img src="fire/loop/l7.png" id="l7" style="display: none;">
<img src="fire/loop/l8.png" id="l8" style="display: none;">
<img src="fire/loop/l9.png" id="l9" style="display: none;">


<img src="fire/start/s0.png" id="s0" style="display: none;">
<img src="fire/start/s1.png" id="s1" style="display: none;">
<img src="fire/start/s2.png" id="s2" style="display: none;">
<img src="fire/start/s3.png" id="s3" style="display: none;">
<img src="fire/start/s4.png" id="s4" style="display: none;">
<img src="fire/start/s5.png" id="s5" style="display: none;">
<img src="fire/start/s6.png" id="s6" style="display: none;">
<img src="fire/start/s7.png" id="s7" style="display: none;">

<img src="fire/end/e0.png" id="e0" style="display: none;">
<img src="fire/end/e1.png" id="e1" style="display: none;">
<img src="fire/end/e2.png" id="e2" style="display: none;">
<img src="fire/end/e3.png" id="e3" style="display: none;">
<img src="fire/end/e4.png" id="e4" style="display: none;">
<img src="fire/end/e5.png" id="e5" style="display: none;">

<img src="explosion/ex0.png" id="ex0" style="display: none;">
<img src="explosion/ex1.png" id="ex1" style="display: none;">
<img src="explosion/ex2.png" id="ex2" style="display: none;">
<img src="explosion/ex3.png" id="ex3" style="display: none;">
<img src="explosion/ex4.png" id="ex4" style="display: none;">
<img src="explosion/ex5.png" id="ex5" style="display: none;">
<img src="explosion/ex6.png" id="ex6" style="display: none;">
<img src="explosion/ex7.png" id="ex7" style="display: none;">
<img src="explosion/ex8.png" id="ex8" style="display: none;">
<img src="explosion/ex9.png" id="ex9" style="display: none;">
<img src="explosion/ex10.png" id="ex10" style="display: none;">

<img src="smoke/sm0.png" id="sm0" style="display: none;">
<img src="smoke/sm1.png" id="sm1" style="display: none;">
<img src="smoke/sm2.png" id="sm2" style="display: none;">
<img src="smoke/sm3.png" id="sm3" style="display: none;">
<img src="smoke/sm4.png" id="sm4" style="display: none;">
<img src="smoke/sm5.png" id="sm5" style="display: none;">
<img src="smoke/sm6.png" id="sm6" style="display: none;">
<img src="smoke/sm7.png" id="sm7" style="display: none;">
<img src="smoke/sm8.png" id="sm8" style="display: none;">
<img src="smoke/sm9.png" id="sm9" style="display: none;">
<img src="smoke/sm10.png" id="sm10" style="display: none;">
<img src="smoke/sm11.png" id="sm11" style="display: none;">
<img src="smoke/sm12.png" id="sm12" style="display: none;">
<img src="smoke/sm13.png" id="sm13" style="display: none;">
<img src="smoke/sm14.png" id="sm14" style="display: none;">
<img src="smoke/sm15.png" id="sm15" style="display: none;">
<img src="smoke/sm16.png" id="sm16" style="display: none;">
<img src="smoke/sm17.png" id="sm17" style="display: none;">
<img src="smoke/sm18.png" id="sm18" style="display: none;">
<img src="smoke/sm19.png" id="sm19" style="display: none;">
<img src="smoke/sm20.png" id="sm20" style="display: none;">
<img src="smoke/sm21.png" id="sm21" style="display: none;">
<img src="smoke/sm22.png" id="sm22" style="display: none;">
<img src="smoke/sm23.png" id="sm23" style="display: none;">
<img src="smoke/sm24.png" id="sm24" style="display: none;">
<img src="smoke/sm25.png" id="sm25" style="display: none;">
<img src="smoke/sm26.png" id="sm26" style="display: none;">
<img src="smoke/sm27.png" id="sm27" style="display: none;">
<img src="smoke/sm28.png" id="sm28" style="display: none;">
<img src="smoke/sm29.png" id="sm29" style="display: none;">

<img src="flame/f0.png" id="f0" style="display: none;">
<img src="flame/f1.png" id="f1" style="display: none;">
<img src="flame/f2.png" id="f2" style="display: none;">
<img src="flame/f3.png" id="f3" style="display: none;">
<img src="flame/f4.png" id="f4" style="display: none;">
<img src="flame/f5.png" id="f5" style="display: none;">
<img src="flame/f6.png" id="f6" style="display: none;">
<img src="flame/f7.png" id="f7" style="display: none;">
<img src="flame/f8.png" id="f8" style="display: none;">
<img src="flame/f9.png" id="f9" style="display: none;">

<img src="obstacles/ob1.png" id="ob1" style="display: none;">
<img src="obstacles/ob2.png" id="ob2" style="display: none;">
<img src="obstacles/ob3.png" id="ob3" style="display: none;">

<img src="pointer/pointer.png" id="pointer" style="display: none;">

<img src="maps/map1.jpg" id="map1" style="display: none;">
<img src="maps/map2.jpg" id="map2" style="display: none;">
<img src="maps/map3.jpg" id="map3" style="display: none;">
<img src="maps/map4.jpg" id="map4" style="display: none;">

<img src="tanks/track.png" id="track" style="display: none;">

<img src="wall.jpg" id="wall" style="display: none;">
<img src="menu.jpg" id="menu" style="display: none;">


<script src="objects.js"></script>
<script src="enemyTanks.js"></script>
<script src="player.js"></script>
<script src="bulletsControl.js"></script>
<script src="gameDrawing.js"></script>


<script>

function startGame() {
    myGameArea.start();
}

var myGameArea = {
    canvas : document.createElement("canvas"),
    start : function() {
        this.canvas.width = fieldMapX;
        this.canvas.height = fieldMapY+50;
        this.context = this.canvas.getContext("2d");
        document.body.insertBefore(this.canvas, document.body.childNodes[0]);
        this.frameNo = 0;
        this.interval = setInterval(updateGameArea, 20);
        window.addEventListener('keydown', function (e) {
            e.preventDefault();
            myGameArea.keys = (myGameArea.keys || []);
            myGameArea.keys[e.keyCode] = (e.type == "keydown");
        })
        window.addEventListener('keyup', function (e) {
            myGameArea.keys[e.keyCode] = (e.type == "keydown");
        })
    },
    stop : function() {
        clearInterval(this.interval);
    },
    clear : function() {
        this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);
    }
}



// MAIN GAME DATA BEFORE START
//////////////////////////////////////////////////////////////////////////////////

// map variables
var kills = new Array();
var killsFire = new Array();
var tanksFire = new Array();
var flames = new Array();
var mines = new Array();
var explosionsM = new Array();
var explosionsH = new Array();
var explosionsDead = new Array();
var smoke = new Array();
var tracks = new Array();
var obstacles = new Array();

// area that tanks fight at
var fieldMapX=1000;
var fieldMapY=600;

// tank names
var sTanks = ["Little John", "Mouse", "Bonbon", "Puppy", "Grasshopper", "Butterfly",
 "Hamster", "Chicken chaser", "Sprinter", "Can", "Bastard", "Barker", "Freak", "Athlete", "Herring",
 "Skipper", "Gloomy", "Mosquito", "Sparrow", "Cricket"];

var mTanks = ["Firefly", "Warrior", "Nuttcracker", "Prince", "Pride", "Just cause", "Madman",
 "Dagger", "Sower", "Rammer", "Goblin", "Assassin", "Horn", "Hornet", "Rottweiler", "Robber", "Lionheart", "Jaws",
  "Swordfish", "Shepherd"];

var lTanks = ["Iron", "Butcher", "Turtle", "Beettle", "Knight", "Warcry", "Ram", "Ox", "Hog", "Big Foot", "Buffalo",
"Icebreaker", "Lucifer", "Archangel"];

var totalPoints=0;
var points=0;
var level=0;
var sound=true; // sound in the game
var menuTanks=new Audio('sounds/menuTanks.mp3')
var tankId=0;
var terrain=0;  // 0 - grass, 1 - sand   // ai tanks camo

var cButton=0;
var cTimer=0;
var eTimer=0;
var createMenuTanks=true;


// player tank vars
var pTank = new PTank(500,300);

var bulletsP = new Array();
var mgBulletsP = new Array();

// ai tanks vars
var aiTanks = new Array();
var bulletsAi = new Array();
var mgBulletsAi = new Array();


////////////////////////////////////////////////////////// enemies for test
//obstacles[0] = new Obstacle(800,150,1);
//aiTanks[0] = new AiTank(1100,100);





///////////////////////////////////// MAIN INTERVAL FUNCTION
function updateGameArea() {



if(level==0){ // first screen
  ctx = myGameArea.context;
  ctx.drawImage(wall, 0, 0);
  ctx.font = "50px Arial";
  ctx.fillStyle = "black";
  ctx.fillText("Press enter to start",200,100);
  if (myGameArea.keys && myGameArea.keys[13]){
    eTimer=20;
    level=1;
  }
}



if(level==1){ // main menu

  // playing sound of the tanks in the menu
  if(sound){
    menuTanks.play();
  }else{
    menuTanks.load();
  }

  ctx = myGameArea.context;
  ctx.drawImage(menu, 0, 0);

  ctx.font = "20px Arial";
  ctx.fillStyle = "white";
  ctx.fillText("Total points : "+totalPoints,750,50);

  ctx.font = "30px Arial";

  if(cButton==0){
    ctx.fillStyle = "red";
    ctx.fillText("Campaign",650,150);
  }else{
    ctx.fillStyle = "white";
    ctx.fillText("Campaign",650,150);
  }

  if(cButton==1){
    ctx.fillStyle = "red";
    ctx.fillText("Survival Mode",650,230);
  }else{
    ctx.fillStyle = "white";
    ctx.fillText("Survival Mode",650,230);
  }

  if(cButton==2){
    ctx.fillStyle = "red";
    ctx.fillText("Garage",650,310);
  }else{
    ctx.fillStyle = "white";
    ctx.fillText("Garage",650,310);
  }

  if(sound){
    if(cButton==3){
      ctx.fillStyle = "red";
      ctx.fillText("Sound on",650,390);
    }else{
      ctx.fillStyle = "white";
      ctx.fillText("Sound on",650,390);
    }
  }else{
    if(cButton==3){
      ctx.fillStyle = "red";
      ctx.fillText("Sound off",650,390);
    }else{
      ctx.fillStyle = "white";
      ctx.fillText("Sound off",650,390);
    }
  }

  if(cButton==4){
    ctx.fillStyle = "red";
    ctx.fillText("Author",650,470);
  }else{
    ctx.fillStyle = "white";
    ctx.fillText("Author",650,470);
  }

  if(myGameArea.keys && myGameArea.keys[38] && cTimer==0){
    cTimer=10;
    cButton--;
    if(cButton==-1){
      cButton=4;
    }
  }

  if(myGameArea.keys && myGameArea.keys[40] && cTimer==0){
    cTimer=10;
    cButton++;
    if(cButton==5){
      cButton=0;
    }
  }

  if(cTimer>0){
    cTimer--;
  }
  if(eTimer>0){
    eTimer--;
  }

  // using main menu options
  if(myGameArea.keys && myGameArea.keys[13] && eTimer==0 && cButton==1){
    level=100;
    clearLevel();
    menuTanks.load();
  }

  if(myGameArea.keys && myGameArea.keys[13] && eTimer==0 && cButton==3){
    sound=!sound;
    eTimer=20;
  }




  //// tanks going around
  if(createMenuTanks){
    aiTanks[0] = new AiTank(200,700);
    aiTanks[0].dumb=true;
    aiTanks[1] = new AiTank(143,900);
    aiTanks[1].dumb=true;

    aiTanks[2] = new AiTank3(900,800);
    aiTanks[2].dumb=true;



    createMenuTanks=false;
  }

  // moving in circle1 around
  for(var t = 0; t < aiTanks.length; t++) {

    if(aiTanks[t].type=="one"){

      if(aiTanks[t].y<2000&&aiTanks[t].y>650){
        aiTanks[t].setDes(300,450);
        aiTanks[t].angleB=aiTanks[t].aiDestinationAngle;
      }

      if(aiTanks[t].y<470){
        aiTanks[t].setDes(220,100);
      }
      if(aiTanks[t].y<120){
        aiTanks[t].setDes(-100,-200);
      }
      if(aiTanks[t].y<-150){
        aiTanks[t] = new AiTank(200,800);
        aiTanks[t].dumb=true;
      }
    }

    if(aiTanks[t].type=="three"){

      if(aiTanks[t].y<2000&&aiTanks[t].y>650){
        aiTanks[t].setDes(450,550);
        aiTanks[t].angleB=aiTanks[t].aiDestinationAngle;
      }

      if(aiTanks[t].y<570){
        aiTanks[t].setDes(350,200);
      }
      if(aiTanks[t].y<220){
        aiTanks[t].setDes(400,-200);
      }
      if(aiTanks[t].y<-150){
        aiTanks[t] = new AiTank3(900,800);
        aiTanks[t].dumb=true;
      }
    }

  }

    //////////////////////////// ai tanks drawing
    // tracks
    for(var i = 0; i < tracks.length; i++) {
      if(tracks[i].timer<0){
        tracks.splice(i,1);
      }else{
        tracks[i].update();
      }
    }
    // new positions
    for(var t = 0; t < aiTanks.length; t++) {
      aiTanks[t].newPos();
    }
    // drawing ai tank
    for(var t = 0; t < aiTanks.length; t++) {
      aiTanks[t].update();
    }



}// end of level 1 / menu





if(level==100){ // survival mode

  obstacles[0] = new Obstacle(800,150,1);
  obstacles[1] = new Obstacle(220,110,2);
  obstacles[2] = new Obstacle(300,130,1);
  obstacles[3] = new Obstacle(820,500,2);
  obstacles[4] = new Obstacle(800,370,1);
  obstacles[5] = new Obstacle(100,300,3);
  obstacles[6] = new Obstacle(150,350,2);
  obstacles[7] = new Obstacle(210,330,1);
  obstacles[8] = new Obstacle(360,340,3);

  if(aiTanks.length==0){
    aiTanks[0] = new AiTank(1100,100);
    aiTanks[1] = new AiTank(1400,200);
    aiTanks[2] = new AiTank2(1900,400);
    aiTanks[3] = new AiTank3(2100,500);
  }


if(pTank.alive){
bulletsControl();
gameDrawing();
}else{
  clearLevel();
  level=1;
  createMenuTanks=true;
}

}// end of level 100 / survival mode




}// end of a game update function

</script>





<center>
  <p>MANUAL : ARROWS-move, A,D-turning turrent, SPACE-gun, 1,2-ammo type
     W-body mg, S-turrent mg, E-smoke, Q-flamethrower, G-mines.</p>
</center>

</body>
</html>
