<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<style>
canvas {
    border:1px solid #d3d3d3;
    background-color: #f1f1f1;
    padding-left: 0;
    padding-right: 0;
    margin-left: auto;
    margin-right: auto;
    display: block;
}
</style>
</head>
<body onload="startGame()">

<img src="tanks/rusa.png" id="rusa" style="display: none;">
<img src="tanks/rusb.png" id="rusb" style="display: none;">
<img src="tanks/gera.png" id="gera" style="display: none;">
<img src="tanks/gerb.png" id="gerb" style="display: none;">


<img src="wrecks/rusaw.png" id="rusaw" style="display: none;">
<img src="wrecks/rusbw.png" id="rusbw" style="display: none;">
<img src="wrecks/geraw.png" id="geraw" style="display: none;">
<img src="wrecks/gerbw.png" id="gerbw" style="display: none;">


<img src="fire/loop/l0.png" id="l0" style="display: none;">
<img src="fire/loop/l1.png" id="l1" style="display: none;">
<img src="fire/loop/l2.png" id="l2" style="display: none;">
<img src="fire/loop/l3.png" id="l3" style="display: none;">
<img src="fire/loop/l4.png" id="l4" style="display: none;">
<img src="fire/loop/l5.png" id="l5" style="display: none;">
<img src="fire/loop/l6.png" id="l6" style="display: none;">
<img src="fire/loop/l7.png" id="l7" style="display: none;">
<img src="fire/loop/l8.png" id="l8" style="display: none;">
<img src="fire/loop/l9.png" id="l9" style="display: none;">


<img src="fire/start/s0.png" id="s0" style="display: none;">
<img src="fire/start/s1.png" id="s1" style="display: none;">
<img src="fire/start/s2.png" id="s2" style="display: none;">
<img src="fire/start/s3.png" id="s3" style="display: none;">
<img src="fire/start/s4.png" id="s4" style="display: none;">
<img src="fire/start/s5.png" id="s5" style="display: none;">
<img src="fire/start/s6.png" id="s6" style="display: none;">
<img src="fire/start/s7.png" id="s7" style="display: none;">

<img src="fire/end/e0.png" id="e0" style="display: none;">
<img src="fire/end/e1.png" id="e1" style="display: none;">
<img src="fire/end/e2.png" id="e2" style="display: none;">
<img src="fire/end/e3.png" id="e3" style="display: none;">
<img src="fire/end/e4.png" id="e4" style="display: none;">
<img src="fire/end/e5.png" id="e5" style="display: none;">


<img src="maps/map1.jpg" id="map1" style="display: none;">


<script src="objects.js"></script>

<script>

function startGame() {
    myGameArea.start();
}

var myGameArea = {
    canvas : document.createElement("canvas"),
    start : function() {
        this.canvas.width = fieldMapX;
        this.canvas.height = fieldMapY+50;
        this.context = this.canvas.getContext("2d");
        document.body.insertBefore(this.canvas, document.body.childNodes[0]);
        this.frameNo = 0;
        this.interval = setInterval(updateGameArea, 20);
        window.addEventListener('keydown', function (e) {
            e.preventDefault();
            myGameArea.keys = (myGameArea.keys || []);
            myGameArea.keys[e.keyCode] = (e.type == "keydown");
        })
        window.addEventListener('keyup', function (e) {
            myGameArea.keys[e.keyCode] = (e.type == "keydown");
        })
    },
    stop : function() {
        clearInterval(this.interval);
    },
    clear : function() {
        this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);
    }
}




//////////////////////////////////////////////////////////////////////////////////
// player tank vars
var pTank = new PTank(100,300,rusa,rusb);
var bulletP;
var mgBulletsP = new Array();

var aiTanks = new Array();

aiTanks[0] = new AiTank(1100,300,gera,gerb);
aiTanks[1] = new AiTank(1100,400,gera,gerb);
aiTanks[2] = new AiTank(1100,500,gera,gerb);

aiTanks[3] = new AiTank(2200,300,gera,gerb);
aiTanks[4] = new AiTank(2200,400,gera,gerb);
aiTanks[5] = new AiTank(2200,500,gera,gerb);


var bulletsAi = new Array();
var mgBulletsAi = new Array();

// map variables
var kills = new Array();
var killsFire = new Array();
var mines = new Array();
// area that tanks play at
var fieldMapX=1000;
var fieldMapY=600;










///////////////////////////////////// MAIN FUNCTION
function updateGameArea() {


// Player tank ////////////////////////////////////////


///////////////////////////////////////////////////////////////////////////// player tank



///////////////////////////////////////////////////////////////////////////// ai tank





///////////////////////////////////// drawing objects

// drawing the map
var ctx = myGameArea.context;
var map1=document.getElementById("map1");
ctx.drawImage(map1, 0, 0);

// mines
for(var i = 0; i < mines.length; i++) {
  mines[i].update();
}

// drawing killed tanks
for(var i = 0; i < kills.length; i++) {
  kills[i].update();
}


/////////////////////////////////////////////////////////////////////////
///////////////////////////////// drawing ai
// new positions
for(var t = 0; t < aiTanks.length; t++) {
  aiTanks[t].newPos();
}

  for(var i = 0; i < bulletsAi.length; i++) {
    bulletsAi[i].newPos();
  }
  for(var i = 0; i < mgBulletsAi.length; i++) {
    mgBulletsAi[i].newPos();
  }

// drawing
for(var t = 0; t < aiTanks.length; t++) {
  aiTanks[t].update();
  ctx.fillStyle = "white";
  ctx.font = "10px Arial";
  ctx.fillText("HP",aiTanks[t].x-10,aiTanks[t].y);
  ctx.fillText(aiTanks[t].hp,aiTanks[t].x-10,aiTanks[t].y+20);
}

  for(var i = 0; i < bulletsAi.length; i++) {
    bulletsAi[i].update();
  }
  for(var i = 0; i < mgBulletsAi.length; i++) {
    mgBulletsAi[i].update();
  }


///////////////////////////////// drawing player
// new positions
pTank.newPos();
if(bulletP!=null){
  bulletP.newPos();
}
for(var i = 0; i < mgBulletsP.length; i++) {
  mgBulletsP[i].newPos();
}
// drawing
pTank.update();
if(bulletP!=null){
  bulletP.update();
}
for(var i = 0; i < mgBulletsP.length; i++) {
  mgBulletsP[i].update();
}
//////////////////////////////////////////////////////////////////////////


////////////////////////////////////// drawing smoke and fire effects

// fire at dead tanks
for(var i = 0; i < killsFire.length; i++) {
  killsFire[i].update();
}

// drawing informations about current game

ctx.fillStyle ="black";
ctx.fillRect( 0, 600, 1000, 50);
ctx.font = "20px Arial";
ctx.fillStyle = "white";

ctx.fillText("Player HP",10,620);
ctx.fillText(pTank.hp,10,645);

ctx.fillText("Cannon ammo",110,620);
ctx.fillText(pTank.numBullet,110,645);
if(pTank.reloadTime==0){
  ctx.fillStyle = "red";
  ctx.fillText("ready",160,645);
}else{
  ctx.fillStyle = "white";
  ctx.fillText("loading",160,645);
}

ctx.fillStyle = "white";
ctx.fillText("MG ammo",260,620);
ctx.fillText(pTank.numMgBullets,260,645);

ctx.fillText("Mines",370,620);
ctx.fillText(pTank.numMines,370,645);

}// end of a game update function
</script>



</body>
</html>
